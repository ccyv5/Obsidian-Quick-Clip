# Obsidian Web Clipper - 完整测试清单

## 项目概述

**功能**：Chrome 浏览器扩展，用于保存网页内容到 Obsidian 笔记

**核心特性**：
- 右键菜单快速保存
- 支持文本和图片混合内容
- 创建新文件或追加到现有文件
- Obsidian 兼容的 Markdown 格式
- 可配置的图片处理模式
- 智能文件名处理

---

## 测试前准备

### 环境要求
- [ ] Chrome 88+ 浏览器
- [ ] 准备一个测试文件夹（可以是 Obsidian vault）
- [ ] 准备测试网页（包含文本和图片）

### 安装扩展
1. 打开 `chrome://extensions/`
2. 启用"开发者模式"（右上角）
3. 点击"加载已解压的扩展程序"
4. 选择项目文件夹
5. 确认扩展已加载并启用

---

## 第一部分：基础配置测试

### 测试 1：首次配置
**目标**：验证配置流程

- [ ] 右键点击扩展图标 → 选择"选项"
- [ ] 点击"选择文件夹"按钮
- [ ] 选择测试文件夹
- [ ] 确认显示绿色"已选择: [文件夹名]"
- [ ] 在"自定义前置文本"输入：`## 来源`
- [ ] 在"自定义后置文本"输入：`---`
- [ ] 确认默认配置：
  - [ ] "同名文件自动追加内容" - 已勾选 ✓
  - [ ] "保留图片URL链接" - 已选中 ✓
  - [ ] "快速保存模式" - 已勾选 ✓
- [ ] 点击"保存配置"
- [ ] 确认显示"配置保存成功"

**结果**：✅ 通过 / ❌ 失败

---

## 第二部分：快速保存模式测试

### 测试 2：右键菜单显示
**目标**：验证快速保存菜单

- [ ] 刷新测试网页
- [ ] 选中一段文本
- [ ] 右键点击选中文本
- [ ] 确认菜单中显示"保存到Obsidian"
- [ ] 确认"保存到Obsidian"右侧有 `>` 箭头
- [ ] 鼠标移到"保存到Obsidian"上
- [ ] 确认显示子菜单：
  - [ ] 📝 新建文件...
  - [ ] ----（分隔线）
  - [ ] (暂无文件) 或 现有文件列表

**结果**：✅ 通过 / ❌ 失败

### 测试 3：新建文件保存
**目标**：验证新建文件功能

- [ ] 选中一段文本
- [ ] 右键 → 保存到Obsidian → 📝 新建文件...
- [ ] 等待保存完成
- [ ] 确认显示通知："已保存到: [文件名].md"
- [ ] 在文件夹中找到新文件
- [ ] 打开文件检查内容：
  - [ ] 第一行是页面链接 `[标题](URL)`
  - [ ] 有前置文本 `## 来源`
  - [ ] 有选中的文本内容
  - [ ] 有后置文本 `---`

**结果**：✅ 通过 / ❌ 失败

### 测试 4：追加到现有文件
**目标**：验证追加功能

- [ ] 选中不同的文本
- [ ] 右键 → 保存到Obsidian
- [ ] 确认子菜单中显示刚才创建的文件
- [ ] 点击该文件名
- [ ] 确认显示通知："已追加到: [文件名].md"
- [ ] 打开文件检查：
  - [ ] 原有内容保持不变
  - [ ] 有分隔符 `---`
  - [ ] 新内容追加在末尾

**结果**：✅ 通过 / ❌ 失败

### 测试 5：文件列表实时刷新
**目标**：验证右键时刷新文件列表

- [ ] 在文件夹中删除一个 .md 文件
- [ ] 在网页中选中文本
- [ ] 右键点击
- [ ] 查看 Service Worker 日志（chrome://extensions/ → service worker）
- [ ] 确认看到："Received menu refresh request"
- [ ] 确认菜单中不显示已删除的文件
- [ ] 在文件夹中新建一个 .md 文件
- [ ] 再次右键
- [ ] 确认新文件出现在菜单中

**结果**：✅ 通过 / ❌ 失败

---

## 第三部分：图片处理测试

### 测试 6：URL 模式（默认）
**目标**：验证图片 URL 链接模式

- [ ] 确认配置中选择"保留图片URL链接"
- [ ] 访问包含图片的网页
- [ ] 选中包含文本和图片的区域
- [ ] 右键保存到新文件
- [ ] 确认通知显示："📎 X张图片使用URL链接"
- [ ] 打开文件检查：
  - [ ] 图片格式为 `![alt](https://...)`
  - [ ] 图片在原始位置
  - [ ] 没有创建 images 文件夹

**结果**：✅ 通过 / ❌ 失败

### 测试 7：下载模式
**目标**：验证图片下载功能

- [ ] 打开扩展选项
- [ ] 选择"下载图片到本地"
- [ ] 保存配置
- [ ] 选中包含图片的内容
- [ ] 右键保存到新文件
- [ ] 等待下载完成
- [ ] 确认通知显示："✓ X张图片全部保存成功"
- [ ] 检查文件夹：
  - [ ] 创建了 `images` 子文件夹
  - [ ] 图片文件在 images 文件夹中
- [ ] 打开文件检查：
  - [ ] 图片格式为 `![[images/文件名.ext]]`
  - [ ] 图片在原始位置

**结果**：✅ 通过 / ❌ 失败

---

## 第四部分：文件名处理测试

### 测试 8：同名文件追加（默认）
**目标**：验证同名文件自动追加

- [ ] 确认配置中"同名文件自动追加内容"已勾选
- [ ] 选中内容并保存到新文件（文件名：test）
- [ ] 确认文件创建：`test.md`
- [ ] 选中不同内容，再次保存到新文件（相同文件名：test）
- [ ] 确认通知显示："已追加到: test.md"
- [ ] 确认只有一个文件，内容已追加

**结果**：✅ 通过 / ❌ 失败

### 测试 9：关闭自动追加
**目标**：验证时间戳冲突处理

- [ ] 打开扩展选项
- [ ] 取消勾选"同名文件自动追加内容"
- [ ] 保存配置
- [ ] 选中内容并保存到新文件（文件名：test2）
- [ ] 再次保存到新文件（相同文件名：test2）
- [ ] 确认创建了两个文件：
  - [ ] `test2.md`
  - [ ] `test2-[时间戳].md`

**结果**：✅ 通过 / ❌ 失败

### 测试 10：时间戳模式
**目标**：验证强制时间戳功能

- [ ] 打开扩展选项
- [ ] 勾选"为每个新文件自动添加时间戳"
- [ ] 保存配置
- [ ] 选中内容并保存到新文件（文件名：test3）
- [ ] 确认文件名包含时间戳：`test3-[时间戳].md`
- [ ] 再次保存（相同文件名）
- [ ] 确认创建了新文件（不同时间戳）

**结果**：✅ 通过 / ❌ 失败

### 测试 11：特殊字符处理
**目标**：验证文件名清理

- [ ] 访问标题包含特殊字符的网页（如 `Test: File/Name?`）
- [ ] 选中内容并保存
- [ ] 确认文件名中特殊字符被替换为 `-`
- [ ] 文件成功创建

**结果**：✅ 通过 / ❌ 失败

---

## 第五部分：内容格式测试

### 测试 12：纯文本保存
**目标**：验证文本格式化

- [ ] 选中纯文本内容
- [ ] 保存到新文件
- [ ] 检查文件内容格式：
  - [ ] URL 在第一行
  - [ ] 前置文本正确
  - [ ] 文本内容完整
  - [ ] 后置文本正确
  - [ ] 段落分隔正确

**结果**：✅ 通过 / ❌ 失败

### 测试 13：混合内容保存
**目标**：验证文本和图片混合

- [ ] 选中包含文本和图片的区域
- [ ] 保存到新文件
- [ ] 检查文件：
  - [ ] 文本和图片位置保持一致
  - [ ] 图片在正确的位置
  - [ ] 格式正确

**结果**：✅ 通过 / ❌ 失败

### 测试 14：中文内容
**目标**：验证 Unicode 支持

- [ ] 访问中文网页
- [ ] 选中中文内容
- [ ] 使用中文文件名保存
- [ ] 确认中文内容正确保存
- [ ] 确认中文文件名正确

**结果**：✅ 通过 / ❌ 失败

---

## 第六部分：错误处理测试

### 测试 15：未选中内容
**目标**：验证错误提示

- [ ] 不选中任何内容
- [ ] 右键点击页面
- [ ] 确认"保存到Obsidian"不在菜单中

**结果**：✅ 通过 / ❌ 失败

### 测试 16：未配置文件夹
**目标**：验证配置检查

- [ ] 清除扩展数据（chrome://extensions/ → 详细信息 → 清除数据）
- [ ] 刷新网页
- [ ] 选中内容并右键保存
- [ ] 确认显示警告："未配置目标文件夹"
- [ ] 确认自动打开选项页面

**结果**：✅ 通过 / ❌ 失败

---

## 第七部分：传统模式测试

### 测试 17：关闭快速保存模式
**目标**：验证弹窗模式

- [ ] 打开扩展选项
- [ ] 取消勾选"快速保存模式"
- [ ] 保存配置
- [ ] 刷新网页
- [ ] 选中内容并右键
- [ ] 确认"保存到Obsidian"没有箭头（单一菜单项）
- [ ] 点击"保存到Obsidian"
- [ ] 确认弹窗打开
- [ ] 弹窗显示：
  - [ ] 新文件输入框
  - [ ] 新建文件按钮
  - [ ] 现有文件列表
- [ ] 功能正常工作

**结果**：✅ 通过 / ❌ 失败

---

## 测试总结

**通过的测试**：___ / 17

**失败的测试**：
1. 
2. 
3. 

**发现的问题**：
1. 
2. 
3. 

**总体评价**：
- [ ] 所有功能正常，可以使用
- [ ] 有小问题但不影响使用
- [ ] 有严重问题需要修复

**测试日期**：___________  
**测试人员**：___________  
**Chrome 版本**：___________  
**扩展版本**：1.0.0

---

## 附录：调试技巧

### 查看 Service Worker 日志
1. 打开 `chrome://extensions/`
2. 找到 Obsidian Web Clipper
3. 点击 "service worker" 链接
4. 查看控制台输出

### 查看 Content Script 日志
1. 在测试网页按 F12 打开开发者工具
2. 查看控制台
3. 应该看到："Obsidian Web Clipper content script loaded"

### 查看存储数据
1. 打开 `chrome://extensions/`
2. 找到扩展 → 详细信息
3. 查看"存储"部分
4. 或在开发者工具 → Application → Storage

### 常见问题
- **右键菜单不显示**：刷新网页重新加载 content script
- **文件列表不更新**：查看 Service Worker 日志确认刷新
- **保存失败**：检查文件夹权限和路径
